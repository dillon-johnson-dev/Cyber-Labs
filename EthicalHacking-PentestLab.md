# Ethical Hacking Assignment: Penetration Testing Lab

The purpose of this penetration test was to assess the security posture of Unitecâ€™s public-facing web server. By simulating real-world attack scenarios, we identified vulnerabilities, assessed their risk levels, and provided actionable recommendations to mitigate them. The testing was conducted in response to unusual traffic, which raised concerns about potential compromise.

## **DISCLAIMER**

This test was conducted with explicit authorisation and adhered to ethical hacking principles. All activities were performed within the approved scope to ensure no unnecessary disruptions occurred. The findings are confidential and for internal use only. This was conducted collaboratively with one other team member to simulate a real-world attack scenario. We divided responsibilities and worked together to ensure a comprehensive assessment of the target system.

--- 

## Tools & Techniques
To conduct this penetration test, a combination of active and passive reconnaissance techniques was employed, along with exploitation tools designed to simulate real-world attacks. These tools enabled us to map the server's exposed attack surface, identify vulnerabilities, and assess their potential impact. By leveraging commonly used penetration testing tools, the test demonstrated how attackers might exploit weaknesses and gain unauthorised access to critical systems.

### Reconnaissance
**Nmap**
- Used for active reconnaissance to discover open ports, services, and operating system details.
- Command: sudo nmap 192.168.4.20 -A
- Findings: Exposed critical ports (135, 139, 445), Windows Server 2012 R2 OS, and the domain name NZBBC.local.

![image](https://github.com/user-attachments/assets/94c2e81d-1391-41ad-9891-119212409e88)

**Searchsploit**
- Conducted passive reconnaissance to identify known vulnerabilities for the target OS and services.
- Revealed vulnerabilities such as EternalBlue (MS17-010) for SMB exploitation.
  
![image](https://github.com/user-attachments/assets/d2ed5614-2eed-44a5-836f-4703184ecce8)

**Metasploit**
- Used as the primary exploitation framework to execute attacks.
- Enabled remote code execution via the EternalBlue exploit.
  
  ![image](https://github.com/user-attachments/assets/18e816dc-74ef-4c45-93ba-552fb221cacb)

**Enum4linux**
- Performed active enumeration to gather domain information, and verify access permissions.
- Identified user accounts and exposed SMB shares.
  
![image](https://github.com/user-attachments/assets/ee3a2295-8dc4-4a23-b278-f2a31f806b90)

**John the Ripper**
- Cracked NTLM password hashes extracted during exploitation.
- Demonstrated the risk of weak password policies by revealing plaintext passwords.
  
![image](https://github.com/user-attachments/assets/c37e7518-c33f-49d5-8055-c2d67b87b59d)

**Meterpreter**
- Provided post-exploitation capabilities, such as data exfiltration, privilege escalation, and persistence.
  
![image](https://github.com/user-attachments/assets/03cb6867-a2c5-4008-bdfc-e976880820b4)

**wevtutil**
- Used to clear event logs on the compromised server, demonstrating tactics attackers use to cover their tracks.
  
![image](https://github.com/user-attachments/assets/b252f6b8-c97b-4273-8190-d49734b54a69)

---

## Exploitation and Findings
This section details how vulnerabilities were exploited during the penetration test and the outcomes of those exploitations. By using tools like Metasploit and SMB utilities, we demonstrated how attackers can gain unauthorized access to sensitive systems, escalate privileges, and exfiltrate critical data. The findings underscore the importance of addressing known vulnerabilities and tightening access controls.

**Meterpreter**
- **Exploit Used:** exploit/windows/smb/ms17_010_eternalblue via Metasploit.
- **Process:**
  -  Established a Meterpreter session and dumped NTLM password hashes.
  -  Achieved privilege escalation to NT AUTHORITY\SYSTEM (highest level on a Windows machine).
- **Outcome:**
  -  Extracted sensitive data, including credentials and system information.
  -  Demonstrated the ability to execute arbitrary code remotely, compromising the entire system.
  -  
![image](https://github.com/user-attachments/assets/b77e64ec-e28f-4097-ad93-76244278f70d)
![image](https://github.com/user-attachments/assets/06553a6f-5740-43ca-adac-f3f75b978b18)

**SMB Exploitation**
- Used cracked administrator credentials to access SMB shares.
- Obtained unrestricted access to system files, including critical directories like:
  - ADMIN$
  - NETLOGON
  - SYSLOG
-  Demonstrated potential for lateral movement and deeper network compromise.
- **Outcome:**
  -  Highlighted the risks posed by weak password policies and exposed SMB configurations.

 ![image](https://github.com/user-attachments/assets/3fe35990-6d9f-4240-927e-1c3e32c3cc87)

 ---
 
## Risk Ratings
This section evaluates the severity of the identified vulnerabilities using the CVSS scoring system. By assigning scores to each vulnerability, we provide context for the risks they pose to the organization, including potential business impact and likelihood of exploitation. Understanding these risks is critical for prioritizing remediation efforts.

**EternalBlue Exploit (MS17-010)**
- **CVSS Base Score: 10.0 (Critical)**
- **Risk Analysis:**
  - Remote code execution without authentication.
  - Full administrative access to the server.
  - Potential to spread ransomware (e.g., WannaCry) across the network.
  - Exploitation process is straightforward for attackers with basic Metasploit knowledge.
 - **Business Impact:**
  - Total compromise of server integrity and confidentiality.
  - Potential loss of sensitive customer and organizational data.
  - High likelihood of reputational damage and legal implications.

![image](https://github.com/user-attachments/assets/748948ac-00ae-4a91-81b9-bc6b35954166)

**SMB Exploitation**
- **CVSS Base Score: 7.2 (High)**
- **Risk Analysis:**
  - Weak administrator password cracked in minutes using John the Ripper.
  - Unauthorised access to sensitive directories (e.g., system files, user data).
  - Potential to spread ransomware (e.g., WannaCry) across the network.
  - Exposure of password files in plaintext exacerbates the issue.
 - **Business Impact:**
  - Loss of confidential information.
  - Enables privilege escalation and lateral movement within the network.
  - Increased likelihood of malware or ransomware deployment.

![image](https://github.com/user-attachments/assets/dbd8a933-5bf9-4b1e-a1ab-3165932c1320)

---

## Recommendations
The exploits in this report reveal the huge gaps in security that are leaving your systems and data extremely vulnerable to attacks. However, we can provide steps to mitigate those risks found in these two exploits.

**Eternal Blue**
 -	Apply security patches. Installing a Microsoft update can stop hackers from accessing this vulnerability in your system.
 -	Disable SMB Version 1.0 Protocols. This is another outdated software that needs to be removed so that this attack cannot be performed.
 -	Network Monitoring. Implement Intrusion Detection or Intrusion Prevention Systems to allow you to detect any unusual traffic patterns.
 -	Port 445 Restrictions. Only allow access to internal and trusted IP ranges.

**SMB Access**
 -	Stronger password policy. With us cracking the passwords, we recommend enforcing strong password policies to mitigate the risk of hackers gaining high level access to files. 
 -	MFA. In the event passwords are accessed, applying Multi Factor Authentication increases the layer of defence to stop hackers from being able to authenticate themselves as the rightful user. 
 -	Port 445 Restrictions. Only allow access to internal and trusted IP ranges.

---

## Observations and Key Takeaways
- **Password Complexity Matters:** Weak passwords, like those used in this test (mangga113! and Super@123!), are easily cracked, even with basic tools. Strong, unique passwords must be enforced.
- **Persistence Techniques Are Effective:** The ability to create a persistent backdoor highlights the need for strict monitoring of new user account creation and privileged actions.
- **Log Security:** Clearing logs was trivial, emphasizing the importance of:
  - Forwarding logs to a secure, remote SIEM solution.
  - Monitoring and alerting on log-clearing activities as a possible indicator of compromise.
- **Regular Patching Is Critical:** EternalBlue is a known vulnerability that has been patched for years. The presence of such vulnerabilities indicates outdated software and lax maintenance practices.

---

This penetration testing lab provided a valuable opportunity to apply real-world ethical hacking techniques in a controlled environment. By collaborating effectively and leveraging industry-standard tools, we identified critical vulnerabilities, demonstrated their potential impact, and proposed actionable solutions to mitigate risks. This experience reinforced my technical skills in vulnerability assessment, exploitation, and remediation planning, preparing me to contribute meaningfully to securing organisational systems.
